# c++ 取模运算

通常认为，`%` 是取模运算 modulo operation，求的是「模 modulus」。

但实际上，c/c++ 的 `%` 操作符求的是「余数 remainder」。二者有一些不同。

「余数 reminder」如何计算，取决于「除法」或「带余除法」如何定义，不同定义可能导致不同的余数。大致有如下几种定义：to add later.

- C99 和 C++11 之前：未明确定义，各家实现可能不同。
- C99 和 C++11 开始：用 truncated division (截断除法) 定义。
  - `/` (商) 舍去小数，向 0 取整。`q = int(a / b) = (int) (a/b)`。保证「`a / b = -a / b = a / (-b)`」。
  - `%` (余数) 符号与被除数相同。保证「`商 * b + 余数 = a`」。

那 modulus 呢？数学上，modulus 似乎是用 Euclidean division 定义的（Euclidean mod）。按定义，modulus 必定大于等于 0.

所以，若 a、b 均为正数，则 modulus 与 reminder 相等，是大于等于 0 的。若其中有负数，reminder 可能是负数，而 modulus 仍然是大于等于 0 的，二者可能不同。

a | b | 商 `a/b` | 余数 `a%b`
---- |---- | ---- | ----
7  | 3  | 2  | 1
7  | -3 | -2 | 1
-7 | 3  | -2 | -1
-7 | -3 | 2  | -1

# c++ 函数

remainder of the floating point division operation
- fmod
- fmodf
- fmodl

floating-point remainder of the division operation x / y.
The floating-point remainder of the division operation x / y calculated by this function is exactly the value x - rem * y, where rem is x / y with its fractional part truncated.
The returned value has the same sign as x and is less than y in magnitude.

https://en.cppreference.com/w/cpp/numeric/math/fmod



signed remainder of the division operation
- remainder
- remainderf
- remainderl

IEEE remainder，好像是 四舍五入，rounded to even. (https://en.cppreference.com/w/cpp/numeric/math/remainder)

std::modulus
// haven't figured out what it is

# 应用

考虑到 a % b 的值可能为负数，判断 a 是否为奇数，应该如下定义：
```cpp
    bool is_odd(int a) {
        return a % 2 != 0; // 不是 a % 2 == 1
    }
```

# 其他语言

https://zhuanlan.zhihu.com/p/52903612

java:
%: the remainder of an integer division
Math.floorMod

python:
% 是求模数。
math.fmod() 可以用来计算余数。

go:
%: reminder
math.Mod() 也是求余数。
math.Remainder() 用来计算模数，有时得到的结果有些费解

# 带余除法的多种定义

带余除法，division with remainder

```cpp
    a / b = q ... r, 其中 b ≠ 0, 可正可负
```
- a: 被除数 dividend
- b: 除数 divisor
- q: 商 quotient
- r: 余数 remainder

有多种定义，但不管哪种都要满足 `a = q * b + r`。

## truncated division

- 商：舍去小数，向 0 取整，`q = int(a / b)` 或 `(int) (a / b)`。保证「`a / b = -a / b = a / (-b)`」。
- 余：符号与被除数相同。

## floored division

- 商：向下取整。`q = ⌊a / b⌋ = floor(a / b)`。

## Euclidean division

- 商：保证与被除数符号相同。
- 余：不能为负数。`0 ≤ r < |b|`。

## rounded division

- 商：round half to even。
- 余：值在 -b/2 与 b/2 之间。

## ceiling division

- 商：向上取整。`q = ⌈a / b⌉ = ceil(a / b)`。


# (mod m) notation vs. mod(a, n) operation

后者是我们关心的。

# reference

Division and Modulus for Computer Scientists, by DAAN LEIJEN, dec 2001
